DATABASE STRUCTURE – CLEAN & DEBUG-FRIENDLY
==========================================

DATABASE GOALS
--------------
- Store AI interactions (for debugging)
- Store task breakdown results
- Store panic / grounding responses
- No user accounts required
- Easy to query & inspect


TABLE 1: sessions
-----------------
Purpose:
- Identify a single usage session
- Even without login, this helps grouping requests

Fields:
- session_id (TEXT, PRIMARY KEY)
- created_at (DATETIME)
- user_agent (TEXT, nullable)
- client_ip (TEXT, nullable)

Notes:
- session_id generated by frontend (UUID)
- Helps debugging "what happened in one visit"


TABLE 2: tasks
--------------
Purpose:
- Store user task input + AI breakdown

Fields:
- task_id (INTEGER, PRIMARY KEY, AUTOINCREMENT)
- session_id (TEXT, FOREIGN KEY → sessions.session_id)
- original_input (TEXT)
- task_title (TEXT)
- created_at (DATETIME)

Notes:
- original_input = raw user text
- task_title = AI-generated short title


TABLE 3: task_steps
-------------------
Purpose:
- Store individual steps for a task

Fields:
- step_id (INTEGER, PRIMARY KEY, AUTOINCREMENT)
- task_id (INTEGER, FOREIGN KEY → tasks.task_id)
- step_number (INTEGER)
- step_text (TEXT)
- is_optional (BOOLEAN)

Notes:
- One task → many steps
- Step order is explicit (step_number)


TABLE 4: panic_events
---------------------
Purpose:
- Track panic button usage & responses

Fields:
- panic_id (INTEGER, PRIMARY KEY, AUTOINCREMENT)
- session_id (TEXT)
- trigger_reason (TEXT, nullable)
- ai_response (TEXT)
- created_at (DATETIME)

Notes:
- trigger_reason may be empty
- ai_response is calming / grounding text


TABLE 5: grounding_exercises
----------------------------
Purpose:
- Store grounding exercises returned by AI

Fields:
- exercise_id (INTEGER, PRIMARY KEY, AUTOINCREMENT)
- panic_id (INTEGER, FOREIGN KEY → panic_events.panic_id)
- exercise_type (TEXT)
- instruction_text (TEXT)

Notes:
- One panic event can generate multiple exercises
- Example exercise_type:
  - breathing
  - sensory
  - body_scan


TABLE 6: ai_logs (VERY IMPORTANT)
---------------------------------
Purpose:
- Debugging AI behavior
- Hackathon judges LOVE this

Fields:
- log_id (INTEGER, PRIMARY KEY, AUTOINCREMENT)
- session_id (TEXT)
- endpoint_name (TEXT)
- prompt_sent (TEXT)
- raw_ai_response (TEXT)
- parsed_successfully (BOOLEAN)
- created_at (DATETIME)

Notes:
- This table saves you HOURS of debugging
- You can inspect:
  - bad prompts
  - broken JSON
  - hallucinations


RELATIONSHIP SUMMARY
--------------------
sessions
  ├── tasks
  │     └── task_steps
  ├── panic_events
  │     └── grounding_exercises
  └── ai_logs


WHY THIS STRUCTURE IS GOOD
-------------------------
- No user auth required
- Debug-first design
- Easy SQL queries
- Easy to delete old data
- Easy to add users later


WHAT TO IMPLEMENT FIRST
-----------------------
Phase 1:
- sessions
- tasks
- task_steps

Phase 2:
- panic_events
- grounding_exercises

Phase 3:
- ai_logs (recommended)


DATABASE CHOICE
---------------
Start with:
- SQLite (local development)

Later move to:
- PostgreSQL (deployment)

NO schema changes required.
